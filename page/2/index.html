<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="//img.lujinkai.cn/blog/ljk/1607154764582.png">
  <link rel="icon" type="image/png" sizes="32x32" href="//img.lujinkai.cn/blog/ljk/1607154764582.png">
  <link rel="icon" type="image/png" sizes="16x16" href="//img.lujinkai.cn/blog/ljk/1607154764582.png">
  <link rel="mask-icon" href="//img.lujinkai.cn/blog/ljk/1607154764582.png" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="//s1.lujinkai.cn/libs/fontawesome-free/5.15.4/css/all.min.css">

<script class="next-config" data-name="main" type="application/json">{"hostname":"blog.lujinkai.cn","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.16.0","exturl":false,"sidebar":{"position":"left","display":"always","padding":18,"offset":10},"copycode":{"enable":true,"style":"flat"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"algolia":{"appID":"KN3H1V8A6V","apiKey":"c5d73d0dde2dd770ce49b505f938553d","indexName":"hexo","hits":{"per_page":20,"labels":{"input_placeholder":"Search for Posts","hits_empty":"We did not find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}}}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="LJKのBlog">
<meta property="og:url" content="http://blog.lujinkai.cn/page/2/index.html">
<meta property="og:site_name" content="LJKのBlog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="像方便面一样的男子">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://blog.lujinkai.cn/page/2/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/2/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>LJKのBlog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">LJKのBlog</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">学无止境</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container"></div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container">
  <div class="algolia-stats"><hr></div>
  <div class="algolia-hits"></div>
  <div class="algolia-pagination"></div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="像方便面一样的男子"
      src="//img.lujinkai.cn/blog/ljk/1607154764582.png">
  <p class="site-author-name" itemprop="name">像方便面一样的男子</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">340</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">73</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">99</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/ljkk" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ljkk" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block ljk-index-post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://blog.lujinkai.cn/%E5%89%8D%E7%AB%AF/JavaScript/Map/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//img.lujinkai.cn/blog/ljk/1607154764582.png">
      <meta itemprop="name" content="像方便面一样的男子">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJKのBlog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJKのBlog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/%E5%89%8D%E7%AB%AF/JavaScript/Map/" class="post-title-link" itemprop="url">js的Map</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-12-06 11:36:15" itemprop="dateCreated datePublished" datetime="2022-12-06T11:36:15+08:00">2022-12-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-05-29 16:58:05" itemprop="dateModified" datetime="2023-05-29T16:58:05+08:00">2023-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF/JavaScript/" itemprop="url" rel="index"><span itemprop="name">JavaScript</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Map">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Map</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block ljk-index-post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://blog.lujinkai.cn/%E5%89%8D%E7%AB%AF/JavaScript/Symbol/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//img.lujinkai.cn/blog/ljk/1607154764582.png">
      <meta itemprop="name" content="像方便面一样的男子">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJKのBlog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJKのBlog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/%E5%89%8D%E7%AB%AF/JavaScript/Symbol/" class="post-title-link" itemprop="url">js的Symbol</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-12-06 11:36:15" itemprop="dateCreated datePublished" datetime="2022-12-06T11:36:15+08:00">2022-12-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-05-29 16:58:05" itemprop="dateModified" datetime="2023-05-29T16:58:05+08:00">2023-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF/JavaScript/" itemprop="url" rel="index"><span itemprop="name">JavaScript</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><strong>symbol</strong> 是一种基本数据类型（<a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Glossary/Primitive">primitive data type</a>）。<code>Symbol()</code> 函数会返回 <strong>symbol</strong> 类型的值，该类型具有静态属性和静态方法。它的静态属性会暴露几个内建的成员对象；它的静态方法会暴露全局的 symbol 注册，且类似于内建对象类，但作为构造函数来说它并不完整，因为它不支持语法：”<code>new Symbol()</code>“。</p>
<p>每个从 <code>Symbol()</code> 返回的 symbol 值都是唯一的。一个 symbol 值能作为对象属性的标识符；这是该数据类型仅有的目的。更进一步的解析见—— <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Symbol">glossary entry for Symbol</a>。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Symbol</span>([description])</span><br></pre></td></tr></table></figure>

<p>直接使用<code>Symbol()</code>创建新的 symbol 类型，并用一个可选的字符串作为其描述。</p>
<ul>
<li><p><code>description</code>：可选</p>
<p>可选的，字符串类型。对 symbol 的描述，可用于调试但不是访问 symbol 本身。</p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sym1 = <span class="title class_">Symbol</span>();</span><br><span class="line"><span class="keyword">var</span> sym2 = <span class="title class_">Symbol</span>(<span class="string">&#x27;foo&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> sym3 = <span class="title class_">Symbol</span>(<span class="string">&#x27;foo&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>上面的代码创建了三个新的 symbol 类型。注意，<code>Symbol(&quot;foo&quot;)</code> 不会强制将字符串“foo”转换成 symbol 类型。它每次都会创建一个新的 symbol 类型：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Symbol</span>(<span class="string">&quot;foo&quot;</span>) === <span class="title class_">Symbol</span>(<span class="string">&quot;foo&quot;</span>);  <span class="comment">// false</span></span><br></pre></td></tr></table></figure>

<p>Symbol 值作为属性名时，该属性是公有属性不是私有属性，可以在类的外部访问。但是不会出现在 <code>for...in</code> 、 <code>for...of</code> 的循环中，也不会被 <code>Object.keys()</code> 、 <code>Object.getOwnPropertyNames()</code> 返回。如果要读取到一个对象的 <code>Symbol</code> 属性，可以通过 <code>Object.getOwnPropertySymbols()</code>和 <code>Reflect.ownKeys()</code> 取到。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block ljk-index-post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://blog.lujinkai.cn/%E5%89%8D%E7%AB%AF/JavaScript/js%E4%B8%AD%E7%9A%84%E5%90%8C%E6%AD%A5%E5%92%8C%E5%BC%82%E6%AD%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//img.lujinkai.cn/blog/ljk/1607154764582.png">
      <meta itemprop="name" content="像方便面一样的男子">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJKのBlog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJKのBlog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/%E5%89%8D%E7%AB%AF/JavaScript/js%E4%B8%AD%E7%9A%84%E5%90%8C%E6%AD%A5%E5%92%8C%E5%BC%82%E6%AD%A5/" class="post-title-link" itemprop="url">js中的同步和异步</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-12-06 11:36:15" itemprop="dateCreated datePublished" datetime="2022-12-06T11:36:15+08:00">2022-12-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-05-29 16:58:05" itemprop="dateModified" datetime="2023-05-29T16:58:05+08:00">2023-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF/JavaScript/" itemprop="url" rel="index"><span itemprop="name">JavaScript</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">a</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">fetch</span>(<span class="string">&quot;http://101.43.187.22:9501/api/nav/wallPaper&quot;</span>).<span class="title function_">then</span>(<span class="keyword">async</span> response =&gt; &#123;</span><br><span class="line">        <span class="keyword">const</span> resp = <span class="keyword">await</span> response.<span class="title function_">json</span>()</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(resp)</span><br><span class="line">        <span class="keyword">return</span> resp</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;a&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">b</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;b&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">a</span>()</span><br><span class="line"><span class="title function_">b</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// a</span></span><br><span class="line"><span class="comment">// b</span></span><br><span class="line"><span class="comment">// &#123;code: 200, msg: null, result: Array(8)&#125;</span></span><br></pre></td></tr></table></figure>

<p><code>a()</code>和<code>b()</code> 是同步执行，<code>a()</code>中<code>fetch</code>请求是异步操作。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block ljk-index-post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://blog.lujinkai.cn/Golang/for%E9%81%8D%E5%8E%86%E4%B8%AD%E7%9A%84go%20func/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//img.lujinkai.cn/blog/ljk/1607154764582.png">
      <meta itemprop="name" content="像方便面一样的男子">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJKのBlog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJKのBlog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Golang/for%E9%81%8D%E5%8E%86%E4%B8%AD%E7%9A%84go%20func/" class="post-title-link" itemprop="url">for遍历中的go func</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-09-29 17:05:55" itemprop="dateCreated datePublished" datetime="2022-09-29T17:05:55+08:00">2022-09-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-05-29 16:58:05" itemprop="dateModified" datetime="2023-05-29T16:58:05+08:00">2023-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/" itemprop="url" rel="index"><span itemprop="name">Golang</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>循环变量只是普通变量，每次循环只是重新赋值。</p>
<p>以下两种写法是等价的：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 写法 1</span></span><br><span class="line">list := []<span class="type">string</span>&#123;<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>&#125;</span><br><span class="line"><span class="keyword">var</span> i <span class="type">int</span></span><br><span class="line"><span class="keyword">var</span> v <span class="type">string</span></span><br><span class="line"><span class="keyword">for</span> i, v = <span class="keyword">range</span> list &#123;</span><br><span class="line">    fmt.Println(i, v)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 写法 2</span></span><br><span class="line">list := []<span class="type">string</span>&#123;<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;c&quot;</span>&#125;</span><br><span class="line"><span class="keyword">for</span> i, v := <span class="keyword">range</span> list &#123;</span><br><span class="line">    fmt.Println(i, v)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>循环变量 i 和 v 每次循环都会被重新赋值，并非生成新的变量。</p>
<p>这样就产生了一个问题：如果循环体中有并发操作（最常见的是for中起协程），并且并发中用到了 i 和 v，那么 i 和 v 很可能已经不是此次循环的值了，而是下次甚至是最后一次循环的值。</p>
<p>如果要保证协程中用到的循环变量一定就是此次循环的值，就需要 <strong>绑定循环变量</strong>，两种方式：</p>
<ul>
<li>协程传参</li>
<li>在协程开始之前，新定义变量，将循环变量赋值给新变量，然后协程中使用新变量</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block ljk-index-post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://blog.lujinkai.cn/Golang/%E7%BB%93%E6%9E%84%E4%BD%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//img.lujinkai.cn/blog/ljk/1607154764582.png">
      <meta itemprop="name" content="像方便面一样的男子">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJKのBlog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJKのBlog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Golang/%E7%BB%93%E6%9E%84%E4%BD%93/" class="post-title-link" itemprop="url">结构体</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-09-29 11:30:27" itemprop="dateCreated datePublished" datetime="2022-09-29T11:30:27+08:00">2022-09-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-05-29 16:58:05" itemprop="dateModified" datetime="2023-05-29T16:58:05+08:00">2023-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/" itemprop="url" rel="index"><span itemprop="name">Golang</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="接受者为指针"><a href="#接受者为指针" class="headerlink" title="接受者为指针"></a>接受者为指针</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(dog *Dog)</span></span> SetName(name <span class="type">string</span>) &#123;</span><br><span class="line">    dog.name = name</span><br><span class="line">&#125;</span><br><span class="line">(&amp;dog).SetName(<span class="string">&quot;大黄&quot;</span>) <span class="comment">// 调用</span></span><br><span class="line">dog.Call()    <span class="comment">// 大黄</span></span><br></pre></td></tr></table></figure>

<p><strong>该使用值接收者还是指针接收者，取决于是否现需要修改原始结构体：</strong></p>
<ul>
<li>若不需要修改则使用值，若需要修改则使用指针</li>
<li>若存在指针接收者，则所有方法使用指针接收者</li>
</ul>
<p>对于接收者为指针类型的方法，需要注意在运行时若接收者为 nil 会发生错误。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block ljk-index-post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://blog.lujinkai.cn/ffmpeg/ffmpeg/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//img.lujinkai.cn/blog/ljk/1607154764582.png">
      <meta itemprop="name" content="像方便面一样的男子">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJKのBlog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJKのBlog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/ffmpeg/ffmpeg/" class="post-title-link" itemprop="url">ffmpeg</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-09-24 14:45:34" itemprop="dateCreated datePublished" datetime="2022-09-24T14:45:34+08:00">2022-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-05-29 16:58:05" itemprop="dateModified" datetime="2023-05-29T16:58:05+08:00">2023-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/ffmpeg/" itemprop="url" rel="index"><span itemprop="name">ffmpeg</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg \</span><br><span class="line"> [全局参数] \</span><br><span class="line"> &#123;[输入文件参数] -i 输入文件地址&#125; \</span><br><span class="line"> &#123;[输入文件参数] -i 输入文件地址&#125; \</span><br><span class="line"> &#123;[输入文件参数] -i 输入文件地址&#125; \</span><br><span class="line"> ... \</span><br><span class="line"> &#123;[输出文件参数] 输出文件地址&#125; \</span><br><span class="line"> &#123;[输出文件参数] 输出文件地址&#125; \</span><br><span class="line"> &#123;[输出文件参数] 输出文件地址&#125; \</span><br><span class="line"> ...</span><br></pre></td></tr></table></figure>

<p>要注意的是，所有的参数仅仅对仅接下来的文件有效，下一个文件得把参数再写一遍。</p>
<p>所有没有使用 <code>-i</code> 指定的文件都被认为是输出文件。 ffmpeg 可以接受多个输入文件并输出到您指定的位置。</p>
<p>你也可以将输入输出都指定为同一个文件名，不过这个时候要在输出文件前使用用 <code>-y</code> 标记。</p>
<p>你不应该将输入和输出混淆，先指定输入，再指定输出文件。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block ljk-index-post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://blog.lujinkai.cn/%E5%89%8D%E7%AB%AF/node/yarn%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//img.lujinkai.cn/blog/ljk/1607154764582.png">
      <meta itemprop="name" content="像方便面一样的男子">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJKのBlog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJKのBlog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/%E5%89%8D%E7%AB%AF/node/yarn%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8/" class="post-title-link" itemprop="url">yarn基本使用</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-09-24 14:44:39" itemprop="dateCreated datePublished" datetime="2022-09-24T14:44:39+08:00">2022-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-05-29 16:58:05" itemprop="dateModified" datetime="2023-05-29T16:58:05+08:00">2023-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF/node/" itemprop="url" rel="index"><span itemprop="name">node</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="yarn-v1"><a href="#yarn-v1" class="headerlink" title="yarn v1"></a>yarn v1</h2><table>
<thead>
<tr>
<th>npm (v5)</th>
<th>yarn（1.x）</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>npm install</code></td>
<td><code>yarn add</code></td>
<td>初始化项目</td>
</tr>
<tr>
<td>(N&#x2F;A)</td>
<td><code>yarn add --flat</code></td>
<td></td>
</tr>
<tr>
<td>(N&#x2F;A)</td>
<td><code>yarn add --har</code></td>
<td></td>
</tr>
<tr>
<td><code>npm install --no-package-lock</code></td>
<td><code>yarn add --no-lockfile</code></td>
<td></td>
</tr>
<tr>
<td>(N&#x2F;A)</td>
<td><code>yarn add --pure-lockfile</code></td>
<td></td>
</tr>
<tr>
<td><code>npm install [package] --save</code></td>
<td><code>yarn add [package]</code></td>
<td></td>
</tr>
<tr>
<td><code>npm install [package] --save-dev</code></td>
<td><code>yarn add [package] --dev</code></td>
<td></td>
</tr>
<tr>
<td>(N&#x2F;A)</td>
<td><code>yarn add [package] --peer</code></td>
<td></td>
</tr>
<tr>
<td><code>npm install [package] --save-optional</code></td>
<td><code>yarn add [package] --optional</code></td>
<td></td>
</tr>
<tr>
<td><code>npm install [package] --save-exact</code></td>
<td><code>yarn add [package] --exact</code></td>
<td></td>
</tr>
<tr>
<td>(N&#x2F;A)</td>
<td><code>yarn add [package] --tilde</code></td>
<td></td>
</tr>
<tr>
<td><code>npm install [package] --global</code></td>
<td><code>yarn global add [package]</code></td>
<td></td>
</tr>
<tr>
<td><code>npm update --global</code></td>
<td><code>yarn global upgrade</code></td>
<td></td>
</tr>
<tr>
<td><code>npm rebuild</code></td>
<td><code>yarn add --force</code></td>
<td></td>
</tr>
<tr>
<td><code>npm uninstall [package]</code></td>
<td><code>yarn remove [package]</code></td>
<td></td>
</tr>
<tr>
<td><code>npm cache clean</code></td>
<td><code>yarn cache clean [package]</code></td>
<td></td>
</tr>
<tr>
<td><code>rm -rf node_modules &amp;&amp; npm install</code></td>
<td><code>yarn upgrade</code></td>
<td></td>
</tr>
<tr>
<td><code>npm version major</code></td>
<td><code>yarn version --major</code></td>
<td></td>
</tr>
<tr>
<td><code>npm version minor</code></td>
<td><code>yarn version --minor</code></td>
<td></td>
</tr>
<tr>
<td><code>npm version patch</code></td>
<td><code>yarn version --patch</code></td>
<td></td>
</tr>
</tbody></table>
<h2 id="yarn-v2"><a href="#yarn-v2" class="headerlink" title="yarn v2"></a>yarn v2</h2><p><a target="_blank" rel="noopener" href="https://next.yarnpkg.com/getting-started/install">https://next.yarnpkg.com/getting-started/install</a></p>
<ol>
<li><p>全局安装最新版本的yarn v2</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g yarn@berry</span><br></pre></td></tr></table></figure>
</li>
<li><p>初始化react项目</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn dlx create-react-app my-app --template typescript --use-pnp</span><br></pre></td></tr></table></figure>
</li>
<li><p>1</p>
</li>
</ol>
<p>初始化项目：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn init -2</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block ljk-index-post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://blog.lujinkai.cn/%E5%89%8D%E7%AB%AF/node/%E4%B8%80%E9%94%AE%E6%9B%B4%E6%96%B0package.json%E4%B8%AD%E6%89%80%E6%9C%89%E6%A8%A1%E5%9D%97%E4%B8%BA%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//img.lujinkai.cn/blog/ljk/1607154764582.png">
      <meta itemprop="name" content="像方便面一样的男子">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJKのBlog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJKのBlog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/%E5%89%8D%E7%AB%AF/node/%E4%B8%80%E9%94%AE%E6%9B%B4%E6%96%B0package.json%E4%B8%AD%E6%89%80%E6%9C%89%E6%A8%A1%E5%9D%97%E4%B8%BA%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC/" class="post-title-link" itemprop="url">一键更新package.json中所有模块为最新版本</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-09-24 14:44:19" itemprop="dateCreated datePublished" datetime="2022-09-24T14:44:19+08:00">2022-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-05-29 16:58:05" itemprop="dateModified" datetime="2023-05-29T16:58:05+08:00">2023-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E5%89%8D%E7%AB%AF/node/" itemprop="url" rel="index"><span itemprop="name">node</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/ce9a46ae3a03">https://www.jianshu.com/p/ce9a46ae3a03</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">yarn global add npm-check-updates</span><br><span class="line"></span><br><span class="line"><span class="comment"># cd 到项目目录下</span></span><br><span class="line">ncu -u    <span class="comment"># 检查</span></span><br><span class="line">yarn install  <span class="comment"># 升级</span></span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block ljk-index-post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://blog.lujinkai.cn/Golang/go%E5%B9%B6%E5%8F%91%E7%9A%84GPM%E6%A8%A1%E5%9E%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//img.lujinkai.cn/blog/ljk/1607154764582.png">
      <meta itemprop="name" content="像方便面一样的男子">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJKのBlog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJKのBlog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Golang/go%E5%B9%B6%E5%8F%91%E7%9A%84GPM%E6%A8%A1%E5%9E%8B/" class="post-title-link" itemprop="url">go并发的GPM模型</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-09-24 14:42:01" itemprop="dateCreated datePublished" datetime="2022-09-24T14:42:01+08:00">2022-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-05-29 16:58:05" itemprop="dateModified" datetime="2023-05-29T16:58:05+08:00">2023-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/" itemprop="url" rel="index"><span itemprop="name">Golang</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>马士兵老师对于GPM的讲解，可以说是很通俗易懂了：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1pA411i7Ro?p=2&t=805.3">https://www.bilibili.com/video/BV1pA411i7Ro?p=2&amp;t=805.3</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block ljk-index-post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://blog.lujinkai.cn/Golang/go.mod/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//img.lujinkai.cn/blog/ljk/1607154764582.png">
      <meta itemprop="name" content="像方便面一样的男子">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJKのBlog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJKのBlog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Golang/go.mod/" class="post-title-link" itemprop="url">go.mod</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-09-24 14:41:56" itemprop="dateCreated datePublished" datetime="2022-09-24T14:41:56+08:00">2022-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-05-29 16:58:05" itemprop="dateModified" datetime="2023-05-29T16:58:05+08:00">2023-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/" itemprop="url" rel="index"><span itemprop="name">Golang</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>go.mod 示例：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">module api.local</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="number">1.17</span></span><br><span class="line"></span><br><span class="line">require (</span><br><span class="line">    github.com/jmoiron/sqlx v1<span class="number">.3</span><span class="number">.4</span></span><br><span class="line"> <span class="keyword">go</span>.uber.org/zap v1<span class="number">.21</span><span class="number">.0</span></span><br><span class="line"> gopkg.in/natefinch/lumberjack.v2 v2<span class="number">.0</span><span class="number">.0</span></span><br><span class="line"> gopkg.in/yaml.v2 v2<span class="number">.4</span><span class="number">.0</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">require (</span><br><span class="line"> <span class="keyword">go</span>.uber.org/atomic v1<span class="number">.9</span><span class="number">.0</span> <span class="comment">// indirect</span></span><br><span class="line"> <span class="keyword">go</span>.uber.org/multierr v1<span class="number">.8</span><span class="number">.0</span> <span class="comment">// indirect</span></span><br><span class="line"> gopkg.in/ini.v1 v1<span class="number">.56</span><span class="number">.0</span> <span class="comment">// indirect</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">replace (</span><br><span class="line"> <span class="keyword">go</span>.uber.org/zap =&gt; <span class="keyword">go</span>.uber.org/zap v1<span class="number">.21</span><span class="number">.0</span></span><br><span class="line"> github.com/jmoiron/sqlx =&gt; github.com/jmoiron/sqlx v1<span class="number">.3</span><span class="number">.4</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<ul>
<li>module：用于定义当前项目的模块路径。</li>
<li>go：用于设置预期的 Go 版本。</li>
<li>require：用于设置一个特定的模块版本。</li>
<li>exclude：用于从使用中排除一个特定的模块版本。</li>
<li>replace：用于将一个模块版本替换为另外一个模块版本。</li>
</ul>
<h2 id="环境变量"><a href="#环境变量" class="headerlink" title="环境变量"></a>环境变量</h2><h3 id="GO111MODULE"><a href="#GO111MODULE" class="headerlink" title="GO111MODULE"></a>GO111MODULE</h3><p>Go modules 的开关，auto&#x2F;on&#x2F;off，推荐 on</p>
<p>1.17 中将完全放弃对 GOPATH 模式的支持，忽略 GO111MODULE 变量设置。</p>
<h3 id="GOPROXY"><a href="#GOPROXY" class="headerlink" title="GOPROXY"></a>GOPROXY</h3><p>设置 go 模块代理，用于使 Go 在后续拉取模块版本时能够脱离传统的 VCS 方式从镜像站点快速拉取。它拥有一个默认：<code>https://proxy.golang.org,direct</code>，但很可惜<code>proxy.golang.org</code>在中国无法访问，故而建议使用<code>goproxy.cn</code>作为替代：<code>https://goproxy.cn,direct</code></p>
<p>“direct” 为特殊指示符，用于指示 Go 回源到模块版本的源地址去抓取(比如 GitHub 等)，当值列表中上一个 Go module proxy 返回 404 或 410 错误时，Go 自动尝试列表中的下一个，遇见 “direct” 时回源，遇见 EOF 时终止并抛出类似 “invalid version: unknown revision…” 的错误。</p>
<h3 id="GOSUMDB"><a href="#GOSUMDB" class="headerlink" title="GOSUMDB"></a>GOSUMDB</h3><p>Go checksum database，用于使 Go 在拉取模块版本时(无论是从源站拉取还是通过 Go module proxy 拉取)保证拉取到的模块版本数据未经篡改，也可以是“oﬀ”即禁止 Go 在后续操作中校验模块版本</p>
<p>默认：<code>sum.golang.org</code>，但是在国内无法访问，故而更加建议将 GOPROXY 设置为<code>goproxy.cn</code>，因为<code>goproxy.cn</code>支持代理<code>sum.golang.org</code></p>
<h3 id="GONOPROXY-x2F-GONOSUMDB-x2F-GOPRIVATE"><a href="#GONOPROXY-x2F-GONOSUMDB-x2F-GOPRIVATE" class="headerlink" title="GONOPROXY &#x2F; GONOSUMDB &#x2F; GOPRIVATE"></a>GONOPROXY &#x2F; GONOSUMDB &#x2F; GOPRIVATE</h3><p>这三个环境变量都是用在当前项目依赖了私有模块，也就是依赖了由 GOPROXY 指定的 Go module proxy 或由 GOSUMDB 指定 Go checksum database 无法访问到的模块时的场景。</p>
<p>其中 GOPRIVATE 较为特殊，它的值将作为 GONOPROXY 和 GONOSUMDB 的默认值，所以建议的最佳姿势是只是用 GOPRIVATE。</p>
<p>示例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GOPRIVATE=*.corp.example.com</span><br></pre></td></tr></table></figure>

<p>表示所有模块路径以<code>corp.example.com</code>的下一级域名（如：<code>team1.corp.example.com</code>）为前缀的模块版本都将不经过 Go module proxy 和 Go checksum database，需要注意的是不包括<code>corp.example.com</code>本身。</p>
<h3 id="Global-Caching"><a href="#Global-Caching" class="headerlink" title="Global Caching"></a>Global Caching</h3><p>这个主要是针对 Go modules 的全局缓存数据说明，如下：</p>
<ul>
<li>同一个模块版本的数据只缓存一份，所有其他模块共享使用。</li>
<li>目前所有模块版本数据均缓存在<code>$GOPATH/pkg/mod</code>和<code>$GOPATH/pkg/sum</code>下，未来或将移至<code>$GOCACHE/mod</code>和<code>$GOCACHE/sum</code>下</li>
<li>可以使用<code>go clean -modcache</code>清理所有已缓存的模块版本数据</li>
</ul>
<h2 id="indirect-表示什么意思"><a href="#indirect-表示什么意思" class="headerlink" title="indirect 表示什么意思"></a>indirect 表示什么意思</h2><p><a target="_blank" rel="noopener" href="https://my.oschina.net/renhc/blog/3162751">https://my.oschina.net/renhc/blog/3162751</a></p>
<p>在执行命令 <code>go mod tidy</code> 时，Go module 会自动整理 <code>go.mod 文件</code>，如果有必要会在部分依赖包的后面增加 <code>// indirect</code> 注释。一般而言，被添加注释的包肯定是间接依赖的包，而没有添加 <code>// indirect</code> 注释的包则是直接依赖的包，即明确的出现在某个 <code>import</code> 语句中。</p>
<p>然而，这里需要着重强调的是：并不是所有的间接依赖都会出现在 <code>go.mod</code> 文件中。</p>
<p>间接依赖出现在 <code>go.mod</code> 文件的情况，可能符合下面所列场景的一种或多种：</p>
<ul>
<li>直接依赖未启用 Go module</li>
<li>直接依赖 go.mod 文件中缺失部分依赖</li>
</ul>
<h3 id="直接依赖未启用-Go-module"><a href="#直接依赖未启用-Go-module" class="headerlink" title="直接依赖未启用 Go module"></a>直接依赖未启用 Go module</h3><p>如下图所示，Module A 依赖 B，但是 B 还未切换成 Module，也即没有 <code>go.mod</code> 文件，此时，当使用 <code>go mod tidy</code> 命令更新 A 的 <code>go.mod</code> 文件时，B 的两个依赖 B1 和 B2 将会被添加到 A 的 <code>go.mod</code> 文件中（前提是 A 之前没有依赖 B1 和 B2），并且 B1 和 B2 还会被添加 <code>// indirect</code> 的注释。</p>
<p><img data-src="//img.to2b.cn/blog/lujinkai/1654656257069.png"></p>
<p>此时 Module A 的 <code>go.mod</code> 文件中 require 部分将会变成：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">require (</span><br><span class="line"> B vx.x.x</span><br><span class="line"> B1 vx.x.x <span class="comment">// indirect</span></span><br><span class="line"> B2 vx.x.x <span class="comment">// indirect</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>依赖 B 及 B 的依赖 B1 和 B2 都会出现在 <code>go.mod</code> 文件中。</p>
<h3 id="直接依赖-go-mod-文件不完整"><a href="#直接依赖-go-mod-文件不完整" class="headerlink" title="直接依赖 go.mod 文件不完整"></a>直接依赖 go.mod 文件不完整</h3><p>如上面所述，如果依赖 B 没有 <code>go.mod</code> 文件，则 Module A 将会把 B 的所有依赖记录到 A 的 <code>go.mod</code> 文件中。即便 B 拥有 <code>go.mod</code>，如果 <code>go.mod</code> 文件不完整的话，Module A 依然会记录部分 B 的依赖到 <code>go.mod</code> 文件中。</p>
<p>如下图所示，Module B 虽然提供了 <code>go.mod</code> 文件中，但 <code>go.mod</code> 文件中只添加了依赖 B1，那么此时 A 在引用 B 时，则会在 A 的 <code>go.mod</code> 文件中添加 B2 作为间接依赖，B1 则不会出现在 A 的 <code>go.mod</code> 文件中。</p>
<p><img data-src="//img.to2b.cn/blog/lujinkai/1654656317636.png"></p>
<p>此时 Module A 的 <code>go.mod</code> 文件中 require 部分将会变成：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">require (</span><br><span class="line"> B vx.x.x</span><br><span class="line"> B2 vx.x.x <span class="comment">// indirect</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>由于 B1 已经包含进 B 的 <code>go.mod</code> 文件中，A 的 <code>go.mod</code> 文件则不必再记录，只会记录缺失的 B2。</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><h4 id="为什么要记录间接依赖"><a href="#为什么要记录间接依赖" class="headerlink" title="为什么要记录间接依赖"></a>为什么要记录间接依赖</h4><p>在上面的例子中，如果某个依赖 B 没有 <code>go.mod</code> 文件，在 A 的 <code>go.mod</code> 文件中已经记录了依赖 B 及其版本号，为什么还要增加间接依赖呢？</p>
<p>我们知道 Go module 需要精确地记录软件的依赖情况，虽然此处记录了依赖 B 的版本号，但 B 的依赖情况没有记录下来，所以如果 B 的 <code>go.mod</code> 文件缺失了（或没有）这个信息，则需要在 A 的 <code>go.mod</code> 文件中记录下来。此时间接依赖的版本号将会跟据 Go module 的版本选择机制确定一个最优版本。</p>
<h4 id="如何处理间接依赖"><a href="#如何处理间接依赖" class="headerlink" title="如何处理间接依赖"></a>如何处理间接依赖</h4><p>综上所述间接依赖出现在 <code>go.mod</code> 中，可以一定程度上说明依赖有瑕疵，要么是其不支持 Go module，要么是其 <code>go.mod</code> 文件不完整。</p>
<p>由于 Go 语言从 v1.11 版本才推出 module 的特性，众多开源软件迁移到 go module 还需要一段时间，在过渡期必然会出现间接依赖，但随着时间的推进，在 <code>go.mod</code> 中出现 <code>// indirect</code> 的机率会越来越低。</p>
<p>出现间接依赖可能意味着你在使用过时的软件，如果有精力的话还是推荐尽快消除间接依赖。可以通过使用依赖的新版本或者替换依赖的方式消除间接依赖。</p>
<h4 id="如何查找间接依赖来源"><a href="#如何查找间接依赖来源" class="headerlink" title="如何查找间接依赖来源"></a>如何查找间接依赖来源</h4><p>Go module 提供了 <code>go mod why</code> 命令来解释为什么会依赖某个软件包，若要查看 <code>go.mod</code> 中某个间接依赖是被哪个依赖引入的，可以使用命令 <code>go mod why -m &lt;pkg&gt;</code> 来查看。</p>
<p>另外，命令 <code>go mod why -m all</code> 则可以分析所有依赖的依赖链。</p>
<h2 id="如何锁定版本号"><a href="#如何锁定版本号" class="headerlink" title="如何锁定版本号"></a>如何锁定版本号</h2><p>使用 replace</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block ljk-index-post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://blog.lujinkai.cn/Golang/go%20module/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//img.lujinkai.cn/blog/ljk/1607154764582.png">
      <meta itemprop="name" content="像方便面一样的男子">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJKのBlog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJKのBlog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Golang/go%20module/" class="post-title-link" itemprop="url">go module</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-09-24 14:41:50" itemprop="dateCreated datePublished" datetime="2022-09-24T14:41:50+08:00">2022-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-05-29 16:58:05" itemprop="dateModified" datetime="2023-05-29T16:58:05+08:00">2023-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/" itemprop="url" rel="index"><span itemprop="name">Golang</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>go.mod 示例：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">module api.local</span><br><span class="line"></span><br><span class="line"><span class="keyword">go</span> <span class="number">1.17</span></span><br><span class="line"></span><br><span class="line">require (</span><br><span class="line"> <span class="keyword">go</span>.uber.org/zap v1<span class="number">.21</span><span class="number">.0</span></span><br><span class="line"> gopkg.in/natefinch/lumberjack.v2 v2<span class="number">.0</span><span class="number">.0</span></span><br><span class="line"> gopkg.in/yaml.v2 v2<span class="number">.4</span><span class="number">.0</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">require (</span><br><span class="line"> <span class="keyword">go</span>.uber.org/atomic v1<span class="number">.9</span><span class="number">.0</span> <span class="comment">// indirect</span></span><br><span class="line"> <span class="keyword">go</span>.uber.org/multierr v1<span class="number">.8</span><span class="number">.0</span> <span class="comment">// indirect</span></span><br><span class="line"> gopkg.in/ini.v1 v1<span class="number">.56</span><span class="number">.0</span> <span class="comment">// indirect</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<ul>
<li>module：用于定义当前项目的模块路径。</li>
<li>go：用于设置预期的 Go 版本。</li>
<li>require：用于设置一个特定的模块版本。</li>
<li>exclude：用于从使用中排除一个特定的模块版本。</li>
<li>replace：用于将一个模块版本替换为另外一个模块版本。</li>
</ul>
<h2 id="indirect-表示什么意思"><a href="#indirect-表示什么意思" class="headerlink" title="indirect 表示什么意思"></a>indirect 表示什么意思</h2><p><a target="_blank" rel="noopener" href="https://my.oschina.net/renhc/blog/3162751">https://my.oschina.net/renhc/blog/3162751</a></p>
<p>在执行命令 <code>go mod tidy</code> 时，Go module 会自动整理 <code>go.mod 文件</code>，如果有必要会在部分依赖包的后面增加 <code>// indirect</code> 注释。一般而言，被添加注释的包肯定是间接依赖的包，而没有添加 <code>// indirect</code> 注释的包则是直接依赖的包，即明确的出现在某个 <code>import</code> 语句中。</p>
<p>然而，这里需要着重强调的是：并不是所有的间接依赖都会出现在 <code>go.mod</code> 文件中。</p>
<p>间接依赖出现在 <code>go.mod</code> 文件的情况，可能符合下面所列场景的一种或多种：</p>
<ul>
<li>直接依赖未启用 Go module</li>
<li>直接依赖 go.mod 文件中缺失部分依赖</li>
</ul>
<h3 id="直接依赖未启用-Go-module"><a href="#直接依赖未启用-Go-module" class="headerlink" title="直接依赖未启用 Go module"></a>直接依赖未启用 Go module</h3><p>如下图所示，Module A 依赖 B，但是 B 还未切换成 Module，也即没有 <code>go.mod</code> 文件，此时，当使用 <code>go mod tidy</code> 命令更新 A 的 <code>go.mod</code> 文件时，B 的两个依赖 B1 和 B2 将会被添加到 A 的 <code>go.mod</code> 文件中（前提是 A 之前没有依赖 B1 和 B2），并且 B1 和 B2 还会被添加 <code>// indirect</code> 的注释。</p>
<p><img data-src="//img.to2b.cn/blog/lujinkai/1654656257069.png"></p>
<p>此时 Module A 的 <code>go.mod</code> 文件中 require 部分将会变成：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">require (</span><br><span class="line"> B vx.x.x</span><br><span class="line"> B1 vx.x.x <span class="comment">// indirect</span></span><br><span class="line"> B2 vx.x.x <span class="comment">// indirect</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>依赖 B 及 B 的依赖 B1 和 B2 都会出现在 <code>go.mod</code> 文件中。</p>
<h3 id="直接依赖-go-mod-文件不完整"><a href="#直接依赖-go-mod-文件不完整" class="headerlink" title="直接依赖 go.mod 文件不完整"></a>直接依赖 go.mod 文件不完整</h3><p>如上面所述，如果依赖 B 没有 <code>go.mod</code> 文件，则 Module A 将会把 B 的所有依赖记录到 A 的 <code>go.mod</code> 文件中。即便 B 拥有 <code>go.mod</code>，如果 <code>go.mod</code> 文件不完整的话，Module A 依然会记录部分 B 的依赖到 <code>go.mod</code> 文件中。</p>
<p>如下图所示，Module B 虽然提供了 <code>go.mod</code> 文件中，但 <code>go.mod</code> 文件中只添加了依赖 B1，那么此时 A 在引用 B 时，则会在 A 的 <code>go.mod</code> 文件中添加 B2 作为间接依赖，B1 则不会出现在 A 的 <code>go.mod</code> 文件中。</p>
<p><img data-src="//img.to2b.cn/blog/lujinkai/1654656317636.png"></p>
<p>此时 Module A 的 <code>go.mod</code> 文件中 require 部分将会变成：</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">require (</span><br><span class="line"> B vx.x.x</span><br><span class="line"> B2 vx.x.x <span class="comment">// indirect</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>由于 B1 已经包含进 B 的 <code>go.mod</code> 文件中，A 的 <code>go.mod</code> 文件则不必再记录，只会记录缺失的 B2。</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><h4 id="为什么要记录间接依赖"><a href="#为什么要记录间接依赖" class="headerlink" title="为什么要记录间接依赖"></a>为什么要记录间接依赖</h4><p>在上面的例子中，如果某个依赖 B 没有 <code>go.mod</code> 文件，在 A 的 <code>go.mod</code> 文件中已经记录了依赖 B 及其版本号，为什么还要增加间接依赖呢？</p>
<p>我们知道 Go module 需要精确地记录软件的依赖情况，虽然此处记录了依赖 B 的版本号，但 B 的依赖情况没有记录下来，所以如果 B 的 <code>go.mod</code> 文件缺失了（或没有）这个信息，则需要在 A 的 <code>go.mod</code> 文件中记录下来。此时间接依赖的版本号将会跟据 Go module 的版本选择机制确定一个最优版本。</p>
<h4 id="如何处理间接依赖"><a href="#如何处理间接依赖" class="headerlink" title="如何处理间接依赖"></a>如何处理间接依赖</h4><p>综上所述间接依赖出现在 <code>go.mod</code> 中，可以一定程度上说明依赖有瑕疵，要么是其不支持 Go module，要么是其 <code>go.mod</code> 文件不完整。</p>
<p>由于 Go 语言从 v1.11 版本才推出 module 的特性，众多开源软件迁移到 go module 还需要一段时间，在过渡期必然会出现间接依赖，但随着时间的推进，在 <code>go.mod</code> 中出现 <code>// indirect</code> 的机率会越来越低。</p>
<p>出现间接依赖可能意味着你在使用过时的软件，如果有精力的话还是推荐尽快消除间接依赖。可以通过使用依赖的新版本或者替换依赖的方式消除间接依赖。</p>
<h4 id="如何查找间接依赖来源"><a href="#如何查找间接依赖来源" class="headerlink" title="如何查找间接依赖来源"></a>如何查找间接依赖来源</h4><p>Go module 提供了 <code>go mod why</code> 命令来解释为什么会依赖某个软件包，若要查看 <code>go.mod</code> 中某个间接依赖是被哪个依赖引入的，可以使用命令 <code>go mod why -m &lt;pkg&gt;</code> 来查看。</p>
<p>另外，命令 <code>go mod why -m all</code> 则可以分析所有依赖的依赖链。</p>
<h2 id="如何锁定版本号"><a href="#如何锁定版本号" class="headerlink" title="如何锁定版本号"></a>如何锁定版本号</h2>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block ljk-index-post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://blog.lujinkai.cn/Golang/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/sqlx/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//img.lujinkai.cn/blog/ljk/1607154764582.png">
      <meta itemprop="name" content="像方便面一样的男子">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJKのBlog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJKのBlog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Golang/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/sqlx/" class="post-title-link" itemprop="url">sqlx</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-09-24 14:40:56" itemprop="dateCreated datePublished" datetime="2022-09-24T14:40:56+08:00">2022-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-05-29 16:58:05" itemprop="dateModified" datetime="2023-05-29T16:58:05+08:00">2023-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/" itemprop="url" rel="index"><span itemprop="name">Golang</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">第三方库</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>sqlx 完全兼容 sql</p>
<h2 id="增-x2F-删-x2F-改"><a href="#增-x2F-删-x2F-改" class="headerlink" title="增&#x2F;删&#x2F;改"></a>增&#x2F;删&#x2F;改</h2><h3 id="Exec"><a href="#Exec" class="headerlink" title="Exec"></a>Exec</h3><h3 id="MustExec"><a href="#MustExec" class="headerlink" title="MustExec"></a>MustExec</h3><h2 id="查"><a href="#查" class="headerlink" title="查"></a>查</h2><h3 id="Get"><a href="#Get" class="headerlink" title="Get"></a>Get</h3><h3 id="Select"><a href="#Select" class="headerlink" title="Select"></a>Select</h3><h2 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h2><h3 id="开启"><a href="#开启" class="headerlink" title="开启"></a>开启</h3><h4 id="Beginx"><a href="#Beginx" class="headerlink" title="Beginx"></a>Beginx</h4><h4 id="MustBegin"><a href="#MustBegin" class="headerlink" title="MustBegin"></a>MustBegin</h4><h3 id="提交"><a href="#提交" class="headerlink" title="提交"></a>提交</h3><h4 id="tx-Commit"><a href="#tx-Commit" class="headerlink" title="tx.Commit"></a>tx.Commit</h4><h3 id="回退"><a href="#回退" class="headerlink" title="回退"></a>回退</h3><h4 id="tx"><a href="#tx" class="headerlink" title="tx."></a>tx.</h4><h2 id="预处理"><a href="#预处理" class="headerlink" title="预处理"></a>预处理</h2>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block ljk-index-post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://blog.lujinkai.cn/Golang/%E6%90%AD%E5%BB%BAgin%E8%84%9A%E6%89%8B%E6%9E%B6/validator%E5%8F%82%E6%95%B0%E6%A0%A1%E9%AA%8C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//img.lujinkai.cn/blog/ljk/1607154764582.png">
      <meta itemprop="name" content="像方便面一样的男子">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJKのBlog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJKのBlog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Golang/%E6%90%AD%E5%BB%BAgin%E8%84%9A%E6%89%8B%E6%9E%B6/validator%E5%8F%82%E6%95%B0%E6%A0%A1%E9%AA%8C/" class="post-title-link" itemprop="url">validator参数校验</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-09-24 14:40:49" itemprop="dateCreated datePublished" datetime="2022-09-24T14:40:49+08:00">2022-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-05-29 16:58:05" itemprop="dateModified" datetime="2023-05-29T16:58:05+08:00">2023-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/" itemprop="url" rel="index"><span itemprop="name">Golang</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/%E6%90%AD%E5%BB%BAgin%E8%84%9A%E6%89%8B%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">搭建gin脚手架</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block ljk-index-post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://blog.lujinkai.cn/Golang/%E6%90%AD%E5%BB%BAgin%E8%84%9A%E6%89%8B%E6%9E%B6/systemd%E7%AE%A1%E7%90%86%E8%BF%9B%E7%A8%8B%E8%87%AA%E5%8A%A8%E9%87%8D%E5%90%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//img.lujinkai.cn/blog/ljk/1607154764582.png">
      <meta itemprop="name" content="像方便面一样的男子">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJKのBlog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJKのBlog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Golang/%E6%90%AD%E5%BB%BAgin%E8%84%9A%E6%89%8B%E6%9E%B6/systemd%E7%AE%A1%E7%90%86%E8%BF%9B%E7%A8%8B%E8%87%AA%E5%8A%A8%E9%87%8D%E5%90%AF/" class="post-title-link" itemprop="url">systemd管理进程自动重启</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-09-24 14:40:45" itemprop="dateCreated datePublished" datetime="2022-09-24T14:40:45+08:00">2022-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-05-29 16:58:05" itemprop="dateModified" datetime="2023-05-29T16:58:05+08:00">2023-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/" itemprop="url" rel="index"><span itemprop="name">Golang</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/%E6%90%AD%E5%BB%BAgin%E8%84%9A%E6%89%8B%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">搭建gin脚手架</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>可以使用 systemd 管理 go 进程</p>
<p>systemd 实践: 依据情况自动重启服务，参考：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/W6_Z1zPn3MeDgfGDP263vg">https://mp.weixin.qq.com/s/W6_Z1zPn3MeDgfGDP263vg</a></p>
<blockquote>
<p>systemd 服务异常自动重启很好用，但有的时候希望某些服务只在特定情况下进行重启，其他时候不要自动重启(比如 OOM，需要人工介入)。 本文抛砖引玉，旨在能够让读者对 systemd 的重启机制有一定了解。</p>
</blockquote>
<h2 id="最简单的自动重启范例"><a href="#最简单的自动重启范例" class="headerlink" title="最简单的自动重启范例"></a>最简单的自动重启范例</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=mytest</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">ExecStart=/root/mytest.sh</span><br><span class="line">Restart=always</span><br><span class="line">RestartSec=5</span><br><span class="line">StartLimitInterval=0</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>

<p>重点参数详解</p>
<ul>
<li>Restart&#x3D;always: 只要不是通过 systemctl stop 来停止服务，任何情况下都必须要重启服务，默认值为 no</li>
<li>RestartSec&#x3D;5: 重启间隔，比如某次异常后，等待 5(s)再进行启动，默认值 0.1(s)</li>
<li>StartLimitInterval: 无限次重启，默认是 10 秒内如果重启超过 5 次则不再重启，设置为 0 表示不限次数重启</li>
</ul>
<h2 id="案例需求"><a href="#案例需求" class="headerlink" title="案例需求"></a>案例需求</h2><p>需求：有个业务，当程序因受到 OOM 而退出的时候，不希望自动重启（此时需要人工介入排查），其他情况下可以自动重启</p>
<p>分析：OOM 就是通过 kill -9 来杀进程，因此只要找到方法，告诉 systemd 当该服务遇到 kill -9 时候不自动重启即可</p>
<h2 id="RestartPreventExitStatus-参数"><a href="#RestartPreventExitStatus-参数" class="headerlink" title="RestartPreventExitStatus 参数"></a>RestartPreventExitStatus 参数</h2><p>查询 man systemd.service 发现，systemd 的[Service]段落里支持一个参数，叫做 RestartPreventExitStatus</p>
<p>该参数从字面上看，意思是当符合某些退出状态时不要进行重启。</p>
<p>该参数的值支持 exit code 和信号名 2 种，可写多个，以空格分隔，例如：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RestartPreventExitStatus=143 137 SIGTERM SIGKILL</span><br></pre></td></tr></table></figure>

<p>表示，当退出情况只要符合以下 4 种情况中任意一种时候，则不再进行重启</p>
<ul>
<li>exit code 为 143</li>
<li>exit code 为 137</li>
<li>信号为 TERM</li>
<li>信号为 KILL</li>
</ul>
<p>但具体如何使用，请继续往下看</p>
<h2 id="测试方法"><a href="#测试方法" class="headerlink" title="测试方法"></a>测试方法</h2><p>&#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;mytest.service</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[Unit]</span><br><span class="line">Description=mytest</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=simple</span><br><span class="line">ExecStart=/root/mem</span><br><span class="line">Restart=always</span><br><span class="line">RestartSec=5</span><br><span class="line">StartLimitInterval=0</span><br><span class="line">RestartPreventExitStatus=SIGKILL</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>

<p>&#x2F;root&#x2F;mem.c（不断消耗内存直至发生 OOM）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;malloc.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;stdlib.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;string.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line"></span><br><span class="line">  int <span class="function"><span class="title">main</span></span> ()</span><br><span class="line">  &#123;</span><br><span class="line">      char *p = NULL;</span><br><span class="line">      int count = 1;</span><br><span class="line">      <span class="keyword">while</span>(1)&#123;</span><br><span class="line">          p = (char *)malloc(1024*1024*100);</span><br><span class="line">          <span class="keyword">if</span>(!p)&#123;</span><br><span class="line">              <span class="built_in">printf</span>(<span class="string">&quot;malloc error!n&quot;</span>);</span><br><span class="line">              <span class="built_in">return</span> -1;</span><br><span class="line">          &#125;</span><br><span class="line">          memset(p, 0, 1024*1024*100);</span><br><span class="line">          <span class="built_in">printf</span>(<span class="string">&quot;malloc %dM memoryn&quot;</span>, 100*count++);</span><br><span class="line">          usleep(500000);</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>编译及执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gcc -o /root/mem /root/mem.c</span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl start mytest</span><br></pre></td></tr></table></figure>

<h2 id="测试结果"><a href="#测试结果" class="headerlink" title="测试结果"></a>测试结果</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@fzxiaomange ~]<span class="comment"># systemctl status mytest</span></span><br><span class="line">      ● mytest.service - mytest</span><br><span class="line">         Loaded: loaded (/usr/lib/systemd/system/mytest.service; disabled; vendor preset: disabled)</span><br><span class="line">         Active: failed (Result: signal) since Sat 2018-10-20 23:32:24 CST; 45s ago</span><br><span class="line">        Process: 10555 ExecStart=/root/mem (code=killed, signal=KILL)</span><br><span class="line">       Main PID: 10555 (code=killed, signal=KILL)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      Oct 20 23:31:55 fzxiaomange.com systemd[1]: Started mytest.</span><br><span class="line">      Oct 20 23:31:55 fzxiaomange.com systemd[1]: Starting mytest...</span><br><span class="line">      Oct 20 23:32:24 fzxiaomange.com systemd[1]: mytest.service: main process exited, code=killed, status=9/KILL</span><br><span class="line">      Oct 20 23:32:24 fzxiaomange.com systemd[1]: Unit mytest.service entered failed state.</span><br><span class="line">      Oct 20 23:32:24 fzxiaomange.com systemd[1]: mytest.service failed.</span><br></pre></td></tr></table></figure>

<p>重点看上面第 6 行 <code>MainPID:10555(code=killed,signal=KILL)</code>，这行表示主进程的状态，常见有 2 种情况</p>
<ul>
<li>code&#x3D;exited, status&#x3D;143：表示 systemd 认为主进程自行退出的，exit code 为 143</li>
<li>code&#x3D;killed, signal&#x3D;KILL：表示 systemd 认为主进程是被 kill 的，接收到的信号是 SIGKILL</li>
</ul>
<p>等待 5 秒后，并没有自动重启，符合预期</p>
<p>此时将 RestartPreventExitStatus&#x3D;SIGKILL 改为 RestartPreventExitStatus&#x3D;SIGTERM</p>
<p>执行 systemctl restart mytest，再进行一次观察，等待 5 秒后，服务自动重启，符合预期</p>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><h3 id="RestartPreventExitStatus-与-Restart-的关系"><a href="#RestartPreventExitStatus-与-Restart-的关系" class="headerlink" title="RestartPreventExitStatus 与 Restart 的关系"></a>RestartPreventExitStatus 与 Restart 的关系</h3><p>配置 RestartPreventExitStatus&#x3D;后，并没有完全忽略 Restart&#x3D;，而是指当退出情况与 RestartPreventExitStatus&#x3D;匹配的时候，才忽略 Restart&#x3D;，若没有匹配，根据 Restart&#x3D;该怎么样还怎么样（具体详见后面的详细测试数据）</p>
<h3 id="kill-子进程会是什么情况"><a href="#kill-子进程会是什么情况" class="headerlink" title="kill 子进程会是什么情况"></a>kill 子进程会是什么情况</h3><p>若 systemd 启动的不是一个简单进程，而是会派生子进程的情况（比如执行 shell 脚本，shell 脚本里启动多个程序），那么当另外开一个窗口通过 <code>kill-信号</code>测试时，会是什么情况呢，先贴出测试方法</p>
<p>ExecStart&#x3D;&#x2F;root&#x2F;mem 改为 ExecStart&#x3D;&#x2F;root&#x2F;mytest.sh</p>
<p>&#x2F;root&#x2F;mytest.sh 内容为</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">sleep</span> 100000 &amp;</span><br><span class="line"></span><br><span class="line"><span class="built_in">sleep</span> 200000</span><br></pre></td></tr></table></figure>

<p>测试结果</p>
<ul>
<li>若 kill 主进程 PID（kill 不带参数），则主进程状态为 <code>code=killed,signal=TERM</code></li>
<li>若 kill -9 主进程 PID，则主进程状态为 <code>code=killed,signal=KILL</code></li>
<li>若 kill 最后一个子进程 PID（kill 不带参数），则 systemd 不认为是接收到信号，而是根据最后一个进程的 exit code 进行处理，此时主进程状态为 <code>code=exited,status=143</code></li>
<li>若 kill -9 最后一个子进程 PID，此时主进程状态为 <code>code=exited,status=137</code></li>
</ul>
<h2 id="详细测试数据"><a href="#详细测试数据" class="headerlink" title="详细测试数据"></a>详细测试数据</h2><p>上面有提到 RestartPreventExitStatus 和 Restart 的关系，但没有数据说明</p>
<p>另外，kill 和 kill -9 的区别，也需要有一份数据说明</p>
<p>因此做了一个详细对比，这里附上详细数据</p>
<p><img data-src="//img.to2b.cn/blog/ljk/1643474237714.png"></p>
<h2 id="systemd-vs-supervisord"><a href="#systemd-vs-supervisord" class="headerlink" title="systemd vs supervisord"></a>systemd vs supervisord</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/jackliu16/article/details/79899012">https://blog.csdn.net/jackliu16/article/details/79899012</a></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block ljk-index-post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://blog.lujinkai.cn/Golang/%E6%90%AD%E5%BB%BAgin%E8%84%9A%E6%89%8B%E6%9E%B6/swagger%E7%94%9F%E6%88%90%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//img.lujinkai.cn/blog/ljk/1607154764582.png">
      <meta itemprop="name" content="像方便面一样的男子">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJKのBlog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJKのBlog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Golang/%E6%90%AD%E5%BB%BAgin%E8%84%9A%E6%89%8B%E6%9E%B6/swagger%E7%94%9F%E6%88%90%E6%8E%A5%E5%8F%A3%E6%96%87%E6%A1%A3/" class="post-title-link" itemprop="url">swagger生成接口文档</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-09-24 14:40:40" itemprop="dateCreated datePublished" datetime="2022-09-24T14:40:40+08:00">2022-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-05-29 16:58:05" itemprop="dateModified" datetime="2023-05-29T16:58:05+08:00">2023-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/" itemprop="url" rel="index"><span itemprop="name">Golang</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/%E6%90%AD%E5%BB%BAgin%E8%84%9A%E6%89%8B%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">搭建gin脚手架</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block ljk-index-post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://blog.lujinkai.cn/Golang/%E6%90%AD%E5%BB%BAgin%E8%84%9A%E6%89%8B%E6%9E%B6/Makefile/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//img.lujinkai.cn/blog/ljk/1607154764582.png">
      <meta itemprop="name" content="像方便面一样的男子">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJKのBlog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJKのBlog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Golang/%E6%90%AD%E5%BB%BAgin%E8%84%9A%E6%89%8B%E6%9E%B6/Makefile/" class="post-title-link" itemprop="url">Makefile</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-09-24 14:40:35" itemprop="dateCreated datePublished" datetime="2022-09-24T14:40:35+08:00">2022-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-05-29 16:58:05" itemprop="dateModified" datetime="2023-05-29T16:58:05+08:00">2023-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/" itemprop="url" rel="index"><span itemprop="name">Golang</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/%E6%90%AD%E5%BB%BAgin%E8%84%9A%E6%89%8B%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">搭建gin脚手架</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block ljk-index-post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://blog.lujinkai.cn/Golang/%E6%90%AD%E5%BB%BAgin%E8%84%9A%E6%89%8B%E6%9E%B6/http%E5%8E%8B%E6%B5%8B%E5%B7%A5%E5%85%B7ab%E5%92%8Cwrk/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//img.lujinkai.cn/blog/ljk/1607154764582.png">
      <meta itemprop="name" content="像方便面一样的男子">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJKのBlog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJKのBlog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Golang/%E6%90%AD%E5%BB%BAgin%E8%84%9A%E6%89%8B%E6%9E%B6/http%E5%8E%8B%E6%B5%8B%E5%B7%A5%E5%85%B7ab%E5%92%8Cwrk/" class="post-title-link" itemprop="url">http压测工具ab和wrk</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-09-24 14:40:33" itemprop="dateCreated datePublished" datetime="2022-09-24T14:40:33+08:00">2022-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-05-29 16:58:05" itemprop="dateModified" datetime="2023-05-29T16:58:05+08:00">2023-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/" itemprop="url" rel="index"><span itemprop="name">Golang</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/%E6%90%AD%E5%BB%BAgin%E8%84%9A%E6%89%8B%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">搭建gin脚手架</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block ljk-index-post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://blog.lujinkai.cn/Golang/%E6%90%AD%E5%BB%BAgin%E8%84%9A%E6%89%8B%E6%9E%B6/%E4%BD%BF%E7%94%A8pprof%E8%BF%9B%E8%A1%8C%E6%80%A7%E5%88%86%E6%9E%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//img.lujinkai.cn/blog/ljk/1607154764582.png">
      <meta itemprop="name" content="像方便面一样的男子">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJKのBlog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJKのBlog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Golang/%E6%90%AD%E5%BB%BAgin%E8%84%9A%E6%89%8B%E6%9E%B6/%E4%BD%BF%E7%94%A8pprof%E8%BF%9B%E8%A1%8C%E6%80%A7%E5%88%86%E6%9E%90/" class="post-title-link" itemprop="url">使用pprof进行性分析</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-09-24 14:40:27" itemprop="dateCreated datePublished" datetime="2022-09-24T14:40:27+08:00">2022-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-05-29 16:58:05" itemprop="dateModified" datetime="2023-05-29T16:58:05+08:00">2023-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/" itemprop="url" rel="index"><span itemprop="name">Golang</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/%E6%90%AD%E5%BB%BAgin%E8%84%9A%E6%89%8B%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">搭建gin脚手架</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block ljk-index-post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://blog.lujinkai.cn/Golang/%E6%90%AD%E5%BB%BAgin%E8%84%9A%E6%89%8B%E6%9E%B6/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//img.lujinkai.cn/blog/ljk/1607154764582.png">
      <meta itemprop="name" content="像方便面一样的男子">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJKのBlog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJKのBlog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Golang/%E6%90%AD%E5%BB%BAgin%E8%84%9A%E6%89%8B%E6%9E%B6/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/" class="post-title-link" itemprop="url">单元测试</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-09-24 14:40:22" itemprop="dateCreated datePublished" datetime="2022-09-24T14:40:22+08:00">2022-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-05-29 16:58:05" itemprop="dateModified" datetime="2023-05-29T16:58:05+08:00">2023-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/" itemprop="url" rel="index"><span itemprop="name">Golang</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/%E6%90%AD%E5%BB%BAgin%E8%84%9A%E6%89%8B%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">搭建gin脚手架</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block ljk-index-post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://blog.lujinkai.cn/Golang/%E6%90%AD%E5%BB%BAgin%E8%84%9A%E6%89%8B%E6%9E%B6/%E4%B8%AD%E9%97%B4%E4%BB%B6/jwt/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="//img.lujinkai.cn/blog/ljk/1607154764582.png">
      <meta itemprop="name" content="像方便面一样的男子">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LJKのBlog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | LJKのBlog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/Golang/%E6%90%AD%E5%BB%BAgin%E8%84%9A%E6%89%8B%E6%9E%B6/%E4%B8%AD%E9%97%B4%E4%BB%B6/jwt/" class="post-title-link" itemprop="url">jwt</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-09-24 14:40:19" itemprop="dateCreated datePublished" datetime="2022-09-24T14:40:19+08:00">2022-09-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-05-29 16:58:05" itemprop="dateModified" datetime="2023-05-29T16:58:05+08:00">2023-05-29</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/" itemprop="url" rel="index"><span itemprop="name">Golang</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/%E6%90%AD%E5%BB%BAgin%E8%84%9A%E6%89%8B%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">搭建gin脚手架</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Golang/%E6%90%AD%E5%BB%BAgin%E8%84%9A%E6%89%8B%E6%9E%B6/%E4%B8%AD%E9%97%B4%E4%BB%B6/" itemprop="url" rel="index"><span itemprop="name">中间件</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="上一页" aria-label="上一页" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/17/">17</a><a class="extend next" rel="next" title="下一页" aria-label="下一页" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">鲁ICP备18016600号-3 </a>
  </div>

<div class="copyright">
  &copy; 2018 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">像方便面一样的男子</span>
</div>

    </div>
  </footer>

  
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="//s1.lujinkai.cn/libs/animejs/3.2.1/anime.min.js"></script>
  <script src="//s1.lujinkai.cn/libs/lozad.js/1.16.0/lozad.min.js"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script>

  <script src="//s1.lujinkai.cn/libs/algoliasearch/4.11.0/algoliasearch-lite.umd.min.js"></script>
<script src="//s1.lujinkai.cn/libs/instantsearch.js/4.36.0/instantsearch.production.min.js"></script><script src="/js/third-party/search/algolia-search.js"></script>






  





</body>
</html>
